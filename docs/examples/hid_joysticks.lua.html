<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>Copilot for FSLabs 1.2.0</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>Copilot for FSLabs 1.2.0</h1>

<ul>
  <li><a href="../index.html">Index</a></li>
</ul>



<h2>Examples</h2>
<ul class="nowrap">
  <li><a href="../examples/cockpit_control_binds.lua.html">cockpit_control_binds.lua</a></li>
  <li><a href="../examples/custom.lua.html">custom.lua</a></li>
  <li><strong>hid_joysticks.lua</strong></li>
</ul>
<h2>Libraries</h2>
<ul class="nowrap">
  <li><a href="../libraries/FSL2Lua.html">FSL2Lua</a></li>
  <li><a href="../libraries/copilot.html">copilot</a></li>
  <li><a href="../libraries/Event.html">Event</a></li>
  <li><a href="../libraries/Joystick.html">Joystick</a></li>
</ul>
<h2>Manual</h2>
<ul class="nowrap">
  <li><a href="../manual/flows.md.html">Flows</a></li>
  <li><a href="../manual/installation.md.html">Installation</a></li>
  <li><a href="../manual/listofcontrols.md.html">FSLabs cockpit controls</a></li>
  <li><a href="../manual/standalonescripts.md.html">Standalone FSL2Lua scripts</a></li>
</ul>

</div>

<div id="content">

    <h2>hid_joysticks.lua</h2>
<pre>

<span class="comment">-- Example usage of the <a href="../libraries/Joystick.html#">Joystick</a> library
</span>
FSL = <span class="global">require</span> <span class="string">"FSL2Lua"</span>
FSL:setPilot <span class="string">"CPT"</span>

Joystick.printDeviceInfo() <span class="comment">-- Print info on all devices in the FSUIPC log
</span>
<span class="comment">-- 0x06A3 is the vendor ID and 0x0C2D is the product ID
</span><span class="comment">-- You can get the IDs from Joystick.printDeviceInfo()
</span><span class="comment">-- or HidScanner.exe that comes with FSUIPC (it's in the Utils folder).
</span>myJoy = Joystick.new(<span class="number">0x06A3</span>, <span class="number">0x0C2D</span>)
anotherJoy = Joystick.new(<span class="number">0x06A3</span>, <span class="number">0x0763</span>)

<span class="comment">-- Print all button and axis activity in the FSUIPC log
</span>Joystick.logAllJoysticks()

<span class="comment">-----------------------------------------
</span><span class="comment">---- Buttons ----------------------------
</span><span class="comment">-----------------------------------------
</span>
myJoy:onPress(<span class="number">1</span>, <span class="global">print</span>, <span class="string">"Hello "</span> .. myJoy.info.product .. <span class="string">"!"</span>)

<span class="comment">-- "ON" and "RETR" will be passed as arguments to these <a href="../libraries/FSL2Lua.html#Switch:__call">callbacks</a>.
</span>myJoy:onPress(<span class="number">5</span>,
  FSL.OVHD_EXTLT_Land_L_Switch, <span class="string">"ON"</span>,
  FSL.OVHD_EXTLT_Land_R_Switch, <span class="string">"ON"</span>)

myJoy:onPress(<span class="number">6</span>,
  FSL.OVHD_EXTLT_Land_L_Switch, <span class="string">"RETR"</span>,
  FSL.OVHD_EXTLT_Land_R_Switch, <span class="string">"RETR"</span>)

myJoy:onPress   (<span class="number">2</span>, FSL.PED_COMM_INT_RAD_Switch, <span class="string">"RAD"</span>)
myJoy:onRelease (<span class="number">2</span>, FSL.PED_COMM_INT_RAD_Switch, <span class="string">"OFF"</span>)

<span class="comment">-- <a href="../libraries/FSL2Lua.html#KnobWithoutPositions:rotateLeft">rotateLeft</a> and <a href="../libraries/FSL2Lua.html#KnobWithoutPositions:rotateRight">rotateRight</a> are method names
</span><span class="comment">-- 30 is the repeat interval in milliseconds
</span>myJoy:onPressRepeat(<span class="number">4</span>, <span class="number">30</span>, FSL.OVHD_INTLT_Integ_Lt_Knob, <span class="string">"rotateLeft"</span>)
myJoy:onPressRepeat(<span class="number">3</span>, <span class="number">30</span>, FSL.OVHD_INTLT_Integ_Lt_Knob, <span class="string">"rotateRight"</span>)

<span class="comment">-- Divide the knob in 5 steps and cycle back and forth
</span><span class="comment">-- This a shorter version of:
</span><span class="comment">-- myJoy:onPress(0, function() FSL.OVHD_INTLT_Integ_Lt_Knob:cycle(5) end)
</span>myJoy:onPress(<span class="number">1</span>, FSL.OVHD_INTLT_Integ_Lt_Knob, <span class="string">"cycle"</span>, <span class="number">5</span>)

myJoy:onPress(<span class="number">8</span>,
  FSL.CPT.PED_RADIO_NAV_Guard, <span class="string">"lift"</span>,
  FSL.CPT.PED_RADIO_NAV_Button, <span class="string">"macro"</span>, <span class="string">"leftPress"</span>)

myJoy:onRelease(<span class="number">8</span>,
  FSL.CPT.PED_RADIO_NAV_Button, <span class="string">"macro"</span>, <span class="string">"leftRelease"</span>,
  FSL.CPT.PED_RADIO_NAV_Guard, <span class="string">"close"</span>)

<span class="comment">-----------------------------------------
</span><span class="comment">---- Encoders ---------------------------
</span><span class="comment">-----------------------------------------
</span>
<span class="comment">--[[
  This function takes the time in milliseconds
  that elapsed between the current and previous
  encoder ticks for the current direction and
  returns how many times the encoder callback
  should be invoked for the current tick.

  If no such function is passed to setTickCalculator,
  the callbacks will be invoked once per tick.
]]</span>
<span class="keyword">function</span> calculateKnobTicks(diff)
  <span class="keyword">if</span> diff &lt; <span class="number">30</span> <span class="keyword">then</span> <span class="keyword">return</span> <span class="number">10</span> <span class="keyword">end</span>
  <span class="keyword">if</span> diff &lt; <span class="number">50</span> <span class="keyword">then</span> <span class="keyword">return</span> <span class="number">5</span> <span class="keyword">end</span>
  <span class="keyword">return</span> <span class="number">1</span>
<span class="keyword">end</span>

<span class="comment">-- The encoder output needs to be debounced in
</span><span class="comment">-- the firmware or hardware for the function
</span><span class="comment">-- to work properly
</span>myJoy:makeEncoder { <span class="number">8</span>, <span class="number">9</span>, detentsPerCycle = <span class="number">4</span> }
  :setTickCalculator(calculateKnobTicks)
  :onCW(FSL.GSLD_FCU_HDG_Knob, <span class="string">"rotateRight"</span>)
  :onCCW(FSL.GSLD_FCU_HDG_Knob, <span class="string">"rotateLeft"</span>)

<span class="comment">-----------------------------------------
</span><span class="comment">---- Axes -------------------------------
</span><span class="comment">-----------------------------------------
</span>
myJoy:onAxis(<span class="string">"Y"</span>, FSL.GSLD_FCU_DimLt_Knob)

<span class="comment">-- Invert the axis for this callback
</span>myJoy:onAxis(<span class="string">"Z"</span>, FSL.CPT.PED_COMM_VHF1_Knob):props():invert()

<span class="comment">-----------------------------------------
</span>
<span class="comment">-- Start reading the data
</span>Joystick.read()

<span class="comment">--[[

Joystick.read() never returns, so if you need to do
other things in the same script, call Joystick.peek()
in a loop or timer instead:

while true do
  ipc.sleep(0)
  Joystick.peek()
  print "doing stuff"
end

]]</span></pre>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.6</a></i>
<i style="float:right;">Last updated 2021-02-12 01:27:47 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
